"use strict";!function(a){function b(a){var b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return b[c]}function c(){var a={},b=null,c={style:"fill",direction:"horizontal",randomProgress:!0};this.profile=function(c,d){if(1==arguments.length){if(b)throw Error("Default profile already set.");b=c}else{if(a[c])throw Error("Profile ["+c+"] aready set.");a[c]=d}},this.$get=function(){return{getProfile:function(d){return d&&a[d]?a[d]:b||c}}}}function d(c,d,e,f){return{restrict:"A",transclude:!0,scope:{progressButton:"&",pbStyle:"@",pbDirection:"@",pbProfile:"@",customEvent:"@"},template:'<span class="content" ng-transclude></span><span class="progress"><span class="progress-inner" ng-style="progressStyles" ng-class="{ notransition: !allowProgressTransition }"></span></span>',controller:function(){},link:function(g,h,i){function j(){var a=d.getProfile(g.pbProfile);g.pbStyle=g.pbStyle||a.style||"fill","lateral-lines"!=g.pbStyle?g.pbDirection=g.pbDirection||a.direction||"horizontal":g.pbDirection="vertical",g.pbPerspective=0==g.pbStyle.indexOf("rotate")||0==g.pbStyle.indexOf("flip-open"),g.pbRandomProgress=i.pbRandomProgress?"false"!==i.pbRandomProgress:a.randomProgress||!0}function k(a){g.progressStyles[p]=100*a+"%"}function l(){var a=0;return e(function(){a+=(1-a)*Math.random()*.5,k(a)},200)}function m(){g.$apply(function(){g.disabled=!1})}function n(a){function b(a){("opacity"===a.propertyName||a.originalEvent&&"opacity"===a.originalEvent.propertyName)&&(h.off(o,b),g.$apply(function(){g.allowProgressTransition=!1,k(0),g.progressStyles.opacity=1}))}if(o&&(g.progressStyles.opacity=0,h.on(o,b)),"number"==typeof a){var c=a>=0?"state-success":"state-error";h.addClass(c),setTimeout(function(){h.removeClass(c),m()},1500)}else m();h.removeClass("state-loading")}j();var o=b(h[0]),p="vertical"==g.pbDirection?"height":"width",q=a.isUndefined(g.customEvent)?"click":g.customEvent;if(g.pbPerspective){var r=a.element('<span class="progress-wrap"></span>');r.append(h.children()),h.append(r),h.addClass("progress-button-perspective")}g.progressStyles={},g.disabled=!1,g.allowProgressTransition=!1,h.addClass("progress-button"),h.addClass("progress-button-dir-"+g.pbDirection),h.addClass("progress-button-style-"+g.pbStyle),g.$watch("disabled",function(a){h.toggleClass("disabled",a)}),h.on(q,function(){f(function(){if(!g.disabled){g.disabled=!0,h.addClass("state-loading"),g.allowProgressTransition=!0;var a=null;c.when(g.progressButton()).then(function(){k(1),a&&e.cancel(a),n(1)},function(){a&&e.cancel(a),n(-1)},function(a){!g.pbRandomProgress&&k(a)}),g.pbRandomProgress&&(a=l())}},0)})}}}var e=a.module("angular-progress-button-styles",[]);e.provider("progressButtonConfig",c),e.directive("progressButton",d),d.$inject=["$q","progressButtonConfig","$interval","$timeout"]}(angular);